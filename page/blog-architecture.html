<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arquitectura del Juego - Donkey Kong Classic</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="blogstyle.css">
</head>
<body>
    <script src="lang.js"></script>
    <div class="nav-header">
        <a href="blog.html" class="back-button">
            <span data-lang="es">â† Volver al Blog</span>
            <span data-lang="en" style="display:none">â† Back to Blog</span>
        </a>
        <button class="lang-btn" onclick="toggleLanguage()">
            <span data-lang="es">ğŸ‡ºğŸ‡¸ EN</span>
            <span data-lang="en" style="display:none">ğŸ‡ªğŸ‡¸ ES</span>
        </button>
    </div>
    
    <div class="article-container">
        <div class="article-header">
            <h1>
                <span data-lang="es">ğŸ—ï¸ Arquitectura del Juego</span>
                <span data-lang="en" style="display:none">ğŸ—ï¸ Game Architecture</span>
            </h1>
            <p>
                <span data-lang="es">DiseÃ±o modular y patrones de arquitectura para un cÃ³digo mantenible</span>
                <span data-lang="en" style="display:none">Modular design and architecture patterns for maintainable code</span>
            </p>
        </div>

        <div class="article-content">
            <h2>
                <span data-lang="es">VisiÃ³n General de la Arquitectura</span>
                <span data-lang="en" style="display:none">Architecture Overview</span>
            </h2>
            <p>
                <span data-lang="es">El juego sigue una arquitectura modular basada en managers que separa las responsabilidades y promueve la mantenibilidad. El sistema estÃ¡ construido alrededor del concepto de managers especializados que manejan diferentes aspectos del juego.</span>
                <span data-lang="en" style="display:none">The game follows a modular manager-based architecture that separates responsibilities and promotes maintainability. The system is built around the concept of specialized managers that handle different aspects of the game.</span>
            </p>

            <div class="architecture-diagram">
                <pre>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Game Manager  â”‚â”€â”€â”€â”€â”‚  State Manager  â”‚â”€â”€â”€â”€â”‚ Tutorial Managerâ”‚
â”‚   (Coordinador) â”‚    â”‚   (Flujo Juego) â”‚    â”‚   (Aprendizaje) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Entity Manager  â”‚    â”‚Collision Managerâ”‚    â”‚   UI Manager    â”‚
â”‚   (Entidades)   â”‚    â”‚    (FÃ­sica)     â”‚    â”‚  (Interfaz)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Level Manager  â”‚    â”‚ Firebase Managerâ”‚    â”‚  Sound Manager  â”‚
â”‚    (Niveles)    â”‚    â”‚  (Datos Nube)   â”‚    â”‚     (Audio)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</pre>
            </div>

            <h2>
                <span data-lang="es">Componentes Principales</span>
                <span data-lang="en" style="display:none">Main Components</span>
            </h2>

            <h3>
                <span data-lang="es">1. Game Manager (src/game/game_manager.py)</span>
                <span data-lang="en" style="display:none">1. Game Manager (src/game/game_manager.py)</span>
            </h3>
            <p>
                <span data-lang="es"><span class="highlight">PropÃ³sito:</span> Coordinador central que orquesta todos los sistemas del juego.</span>
                <span data-lang="en" style="display:none"><span class="highlight">Purpose:</span> Central coordinator that orchestrates all game systems.</span>
            </p>
            
            <p>
                <span data-lang="es"><span class="highlight">Responsabilidades:</span></span>
                <span data-lang="en" style="display:none"><span class="highlight">Responsibilities:</span></span>
            </p>
            <ul>
                <li>
                    <span data-lang="es">EjecuciÃ³n del bucle principal del juego</span>
                    <span data-lang="en" style="display:none">Main game loop execution</span>
                </li>
                <li>
                    <span data-lang="es">CoordinaciÃ³n de managers</span>
                    <span data-lang="en" style="display:none">Manager coordination</span>
                </li>
                <li>
                    <span data-lang="es">DelegaciÃ³n del manejo de eventos</span>
                    <span data-lang="en" style="display:none">Event handling delegation</span>
                </li>
                <li>
                    <span data-lang="es">CoordinaciÃ³n del renderizado</span>
                    <span data-lang="en" style="display:none">Rendering coordination</span>
                </li>
            </ul>

            <div class="code-block">
                <pre>def run(self):
    <span data-lang="es">"""Bucle principal del juego"""</span><span data-lang="en" style="display:none">"""Main game loop"""</span>
    while self.running:
        self.handle_events()
        self.update()
        self.render()
        self.clock.tick(self.config.FPS)

def handle_events(self):
    <span data-lang="es">"""Delega eventos a los managers apropiados"""</span><span data-lang="en" style="display:none">"""Delegates events to appropriate managers"""</span>
    
def update(self):
    <span data-lang="es">"""Actualiza todos los sistemas del juego"""</span><span data-lang="en" style="display:none">"""Updates all game systems"""</span>
    
def render(self):
    <span data-lang="es">"""Renderiza todos los elementos visuales"""</span><span data-lang="en" style="display:none">"""Renders all visual elements"""</span></pre>
            </div>

            <h3>
                <span data-lang="es">2. Entity Manager (src/managers/entity_manager.py)</span>
                <span data-lang="en" style="display:none">2. Entity Manager (src/managers/entity_manager.py)</span>
            </h3>
            <p>
                <span data-lang="es"><span class="highlight">PropÃ³sito:</span> Gestiona todas las entidades del juego (jugador, enemigos, coleccionables, proyectiles).</span>
                <span data-lang="en" style="display:none"><span class="highlight">Purpose:</span> Manages all game entities (player, enemies, collectibles, projectiles).</span>
            </p>
            
            <p>
                <span data-lang="es"><span class="highlight">Responsabilidades:</span></span>
                <span data-lang="en" style="display:none"><span class="highlight">Responsibilities:</span></span>
            </p>
            <ul>
                <li>
                    <span data-lang="es">GestiÃ³n del ciclo de vida de entidades</span>
                    <span data-lang="en" style="display:none">Entity lifecycle management</span>
                </li>
                <li>
                    <span data-lang="es">Control de spawn y timing</span>
                    <span data-lang="en" style="display:none">Spawn control and timing</span>
                </li>
                <li>
                    <span data-lang="es">Actualizaciones e interacciones de entidades</span>
                    <span data-lang="en" style="display:none">Entity updates and interactions</span>
                </li>
                <li>
                    <span data-lang="es">CoordinaciÃ³n del renderizado</span>
                    <span data-lang="en" style="display:none">Rendering coordination</span>
                </li>
            </ul>

            <div class="code-block">
                <pre>class EntityManager:
    def __init__(self, config):
        self.player = None
        self.enemies = []
        self.collectibles = []
        self.projectiles = []
        
        <span data-lang="es"># Control de spawn</span><span data-lang="en" style="display:none"># Spawn control</span>
        self.spawn_timer = 0
        self.monster_spawn_timer = 0
        self.monsters_spawned = 0</pre>
            </div>

            <h3>
                <span data-lang="es">3. Game State Manager (src/managers/game_state_manager.py)</span>
                <span data-lang="en" style="display:none">3. Game State Manager (src/managers/game_state_manager.py)</span>
            </h3>
            <p>
                <span data-lang="es"><span class="highlight">PropÃ³sito:</span> Gestiona los estados del juego y las transiciones.</span>
                <span data-lang="en" style="display:none"><span class="highlight">Purpose:</span> Manages game states and transitions.</span>
            </p>
            
            <p>
                <span data-lang="es"><span class="highlight">Estados:</span></span>
                <span data-lang="en" style="display:none"><span class="highlight">States:</span></span>
            </p>
            <ul>
                <li>
                    <span data-lang="es"><code>MENU</code> - MenÃº principal</span>
                    <span data-lang="en" style="display:none"><code>MENU</code> - Main menu</span>
                </li>
                <li>
                    <span data-lang="es"><code>TUTORIAL</code> - Modo tutorial</span>
                    <span data-lang="en" style="display:none"><code>TUTORIAL</code> - Tutorial mode</span>
                </li>
                <li>
                    <span data-lang="es"><code>PLAYING</code> - Gameplay activo</span>
                    <span data-lang="en" style="display:none"><code>PLAYING</code> - Active gameplay</span>
                </li>
                <li>
                    <span data-lang="es"><code>PAUSED</code> - Juego pausado</span>
                    <span data-lang="en" style="display:none"><code>PAUSED</code> - Game paused</span>
                </li>
                <li>
                    <span data-lang="es"><code>SHOP</code> - Tienda del juego</span>
                    <span data-lang="en" style="display:none"><code>SHOP</code> - Game shop</span>
                </li>
                <li>
                    <span data-lang="es"><code>GAME_OVER</code> - Pantalla de game over</span>
                    <span data-lang="en" style="display:none"><code>GAME_OVER</code> - Game over screen</span>
                </li>
                <li>
                    <span data-lang="es"><code>LEVEL_COMPLETE</code> - Completar nivel</span>
                    <span data-lang="en" style="display:none"><code>LEVEL_COMPLETE</code> - Level complete</span>
                </li>
            </ul>

            <div class="code-block">
                <pre>def set_state(self, new_state):
    <span data-lang="es">"""TransiciÃ³n segura de estado con validaciÃ³n"""</span><span data-lang="en" style="display:none">"""Safe state transition with validation"""</span>
    
def is_playing(self):
    <span data-lang="es">"""Verifica si estÃ¡ en estados de gameplay activo"""</span><span data-lang="en" style="display:none">"""Checks if in active gameplay states"""</span>
    return self.state in ["PLAYING", "TUTORIAL"]</pre>
            </div>

            <h2>
                <span data-lang="es">Sistema de Entidades</span>
                <span data-lang="en" style="display:none">Entity System</span>
            </h2>

            <h3>
                <span data-lang="es">JerarquÃ­a de Entidades</span>
                <span data-lang="en" style="display:none">Entity Hierarchy</span>
            </h3>
            <div class="architecture-diagram">
                <pre><span data-lang="es">Entity (Base)
â”œâ”€â”€ Player
â”‚   â”œâ”€â”€ Sistema de Movimiento
â”‚   â”œâ”€â”€ Sistema de AnimaciÃ³n
â”‚   â””â”€â”€ Sistema de Inventario
â”œâ”€â”€ Enemy
â”‚   â”œâ”€â”€ Barrel (Dirigido por IA)
â”‚   â””â”€â”€ Monster (MÃ¡quina de estados)
â”œâ”€â”€ Collectible
â”‚   â””â”€â”€ Star (Valores de puntos: 10, 20, 50)
â””â”€â”€ Projectile
    â””â”€â”€ Banana (Explosivo)</span><span data-lang="en" style="display:none">Entity (Base)
â”œâ”€â”€ Player
â”‚   â”œâ”€â”€ Movement System
â”‚   â”œâ”€â”€ Animation System
â”‚   â””â”€â”€ Inventory System
â”œâ”€â”€ Enemy
â”‚   â”œâ”€â”€ Barrel (AI-driven)
â”‚   â””â”€â”€ Monster (State machine)
â”œâ”€â”€ Collectible
â”‚   â””â”€â”€ Star (Point values: 10, 20, 50)
â””â”€â”€ Projectile
    â””â”€â”€ Banana (Explosive)</span></pre>
            </div>

            <h3>
                <span data-lang="es">Sistema del Jugador (src/entities/player.py)</span>
                <span data-lang="en" style="display:none">Player System (src/entities/player.py)</span>
            </h3>
            <p>
                <span data-lang="es"><span class="highlight">CaracterÃ­sticas:</span></span>
                <span data-lang="en" style="display:none"><span class="highlight">Features:</span></span>
            </p>
            <ul>
                <li>
                    <span data-lang="es">AnimaciÃ³n basada en sprites (12 frames para secuencia de salto)</span>
                    <span data-lang="en" style="display:none">Sprite-based animation (12 frames for jump sequence)</span>
                </li>
                <li>
                    <span data-lang="es">Movimiento basado en fÃ­sica</span>
                    <span data-lang="en" style="display:none">Physics-based movement</span>
                </li>
                <li>
                    <span data-lang="es">GestiÃ³n de inventario (bananas, vidas, puntuaciÃ³n)</span>
                    <span data-lang="en" style="display:none">Inventory management (bananas, lives, score)</span>
                </li>
                <li>
                    <span data-lang="es">Manejo de entrada</span>
                    <span data-lang="en" style="display:none">Input handling</span>
                </li>
            </ul>

            <div class="code-block">
                <pre>def update_animation(self):
    <span data-lang="es">"""Maneja la animaciÃ³n de sprites basada en el estado"""</span><span data-lang="en" style="display:none">"""Handles sprite animation based on state"""</span>
    if not self.on_ground and self.sprites['jump']:
        <span data-lang="es"># Reproduce secuencia de animaciÃ³n de salto</span><span data-lang="en" style="display:none"># Play jump animation sequence</span>
        if not self.is_jumping_animation:
            self.is_jumping_animation = True
            self.jump_frame = 0</pre>
            </div>

            <h2>
                <span data-lang="es">Arquitectura de IA</span>
                <span data-lang="en" style="display:none">AI Architecture</span>
            </h2>

            <h3>
                <span data-lang="es">Sistema de IA HÃ­brido</span>
                <span data-lang="en" style="display:none">Hybrid AI System</span>
            </h3>
            <p>
                <span data-lang="es">El juego implementa un sofisticado sistema de IA que combina mÃºltiples enfoques:</span>
                <span data-lang="en" style="display:none">The game implements a sophisticated AI system that combines multiple approaches:</span>
            </p>

            <ol>
                <li>
                    <span data-lang="es"><strong>Capa de DecisiÃ³n Primaria:</strong> LÃ³gica basada en reglas para comportamiento confiable</span>
                    <span data-lang="en" style="display:none"><strong>Primary Decision Layer:</strong> Rule-based logic for reliable behavior</span>
                </li>
                <li>
                    <span data-lang="es"><strong>Capa de ValidaciÃ³n:</strong> Q-Learning para refinamiento de comportamiento</span>
                    <span data-lang="en" style="display:none"><strong>Validation Layer:</strong> Q-Learning for behavior refinement</span>
                </li>
                <li>
                    <span data-lang="es"><strong>Capa de Seguridad:</strong> Mecanismos anti-atasco y de respaldo</span>
                    <span data-lang="en" style="display:none"><strong>Safety Layer:</strong> Anti-stuck and fallback mechanisms</span>
                </li>
            </ol>

            <div class="code-block">
                <pre>def barrel_movement(self, platforms, player_rect=None):
    <span data-lang="es"># 1. DecisiÃ³n primaria basada en reglas</span><span data-lang="en" style="display:none"># 1. Primary rule-based decision</span>
    primary_action = self.decide_primary_action(dx, dy, current_platform, player_platform)
    
    <span data-lang="es"># 2. ValidaciÃ³n Q-Learning</span><span data-lang="en" style="display:none"># 2. Q-Learning validation</span>
    if hasattr(self, 'ai_agent'):
        q_action = self.ai_agent.choose_action(state)
        if self.should_override_action(primary_action, q_action, dx, dy):
            primary_action = q_action
    
    <span data-lang="es"># 3. Ejecutar decisiÃ³n</span><span data-lang="en" style="display:none"># 3. Execute decision</span>
    self.execute_action_decision(primary_action, current_platform, dx)</pre>
            </div>

            <h2>
                <span data-lang="es">GestiÃ³n de Datos</span>
                <span data-lang="en" style="display:none">Data Management</span>
            </h2>

            <h3>
                <span data-lang="es">IntegraciÃ³n con Firebase (src/managers/firebase_manager.py)</span>
                <span data-lang="en" style="display:none">Firebase Integration (src/managers/firebase_manager.py)</span>
            </h3>
            <p>
                <span data-lang="es"><span class="highlight">Servicios Utilizados:</span></span>
                <span data-lang="en" style="display:none"><span class="highlight">Services Used:</span></span>
            </p>
            <ul>
                <li>
                    <span data-lang="es"><strong>Realtime Database:</strong> Leaderboards y guardados en la nube</span>
                    <span data-lang="en" style="display:none"><strong>Realtime Database:</strong> Leaderboards and cloud saves</span>
                </li>
                <li>
                    <span data-lang="es"><strong>Authentication:</strong> GestiÃ³n de usuarios</span>
                    <span data-lang="en" style="display:none"><strong>Authentication:</strong> User management</span>
                </li>
                <li>
                    <span data-lang="es"><strong>REST API:</strong> ComunicaciÃ³n HTTP directa (sin SDK)</span>
                    <span data-lang="en" style="display:none"><strong>REST API:</strong> Direct HTTP communication (no SDK)</span>
                </li>
            </ul>

            <h2>
                <span data-lang="es">ConclusiÃ³n</span>
                <span data-lang="en" style="display:none">Conclusion</span>
            </h2>
            <p>
                <span data-lang="es">Esta arquitectura proporciona una base sÃ³lida para un juego mantenible, extensible y de alto rendimiento, manteniendo una separaciÃ³n limpia de responsabilidades y un manejo robusto de errores. El patrÃ³n de managers permite una fÃ¡cil extensiÃ³n y modificaciÃ³n de funcionalidades sin afectar otros sistemas.</span>
                <span data-lang="en" style="display:none">This architecture provides a solid foundation for a maintainable, extensible, and high-performance game, maintaining clean separation of concerns and robust error handling. The manager pattern allows for easy extension and modification of functionality without affecting other systems.</span>
            </p>
        </div>
    </div>
</body>
</html>